---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog', ({ data }) => {
	return data.draft !== true;
})).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout title="CK Lab">
	<div class="space-y-8">
		{
			posts.map((post) => (
				<article class="group">
                    <div class="flex flex-col sm:flex-row sm:items-baseline sm:justify-between mb-1">
                        <a href={`/posts/${post.slug}/`}>
                            <h2 class="font-serif text-xl font-medium text-gray-900 dark:text-gray-100 hover:underline hover:text-accent dark:hover:text-accent cursor-pointer transition-colors duration-200 decoration-1 underline-offset-2">
                                {post.data.title}
                            </h2>
                        </a>
                        <time
                            datetime={post.data.pubDate.toISOString()}
                            class="font-mono text-xs text-gray-400 dark:text-gray-500 whitespace-nowrap sm:ml-4"
                        >
                            {post.data.pubDate.toLocaleDateString('en-us', {
                                year: 'numeric',
                                month: '2-digit',
                                day: '2-digit',
                            })}
                        </time>
                    </div>
                    {post.data.tags.length > 0 && (
                        <div class="flex gap-2 text-xs font-mono text-gray-500 dark:text-gray-500">
                            {post.data.tags.map(tag => (
                                <span class="before:content-['#'] hover:text-gray-900 dark:hover:text-gray-300 cursor-pointer transition-colors">{tag}</span>
                            ))}
                        </div>
                    )}
				</article>
			))
		}
	</div>
</Layout>
